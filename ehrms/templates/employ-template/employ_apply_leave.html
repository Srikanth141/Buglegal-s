{% extends 'employ-template/base_template.html' %}
{%load mathfilters%} {%load humanize%}
<!-- {% block page_title %}
Leave Report and Apply for Leave
{% endblock page_title %} -->
{% block main_content %}
<!-- <style>
  .table td{
    height: 100px;
    padding: 20px;
  }
  .label{
    font-size: medium;
  }
  input{
    background-color: #393f5c;
  }
  h4{
    color: white;
  }


  

/* .pagination a, .pagination .current-page {
    display: inline-block;
    padding: 8px 12px;
    text-decoration: none;
    margin: 0 4px;
    border: 1px solid #ccc;
    border-radius: 4px;
    transition: background-color 0.3s;
} */


  @media (max-width: 768px) {
     .table{
      width: 100px;
     }
  }
  tr:nth-child(even) {background-color: #242b4d}
       tr:nth-child(odd) {background-color: #2d3354}
</style> -->

<!-- <style>
          .table-bordered {
            border-collapse: collapse;
            width: 100%;
        }
        
        .table-row {
            display: table-row;
        }
        
        .table-cell {
            display: table-cell;
            border: 1px solid #ccc;
            padding: 10px;
        }
        .table--hide{
                display: none;
            }
            .pagination {
    margin: 20px 0;
    text-align: center;
}
            .pagination a, .pagination .current-page {
        display: inline-block;
        padding: 8px 12px;
        text-decoration: none;
        border: 1px solid #ccc;
        border-radius: 4px;
        transition: background-color 0.3s;
        border-radius: 20px;
        text-align: center;
        /* background-color: #3775e0;
        color: white; */
    }
    .act{
  /* background-color: orange; */
  color: white;
  height:50px;
  width:50px;
  border-radius: 20px;

}


        /* Responsive layout for smaller screens */
        @media (max-width: 900px) {
            .table-container {
                overflow-x: hidden;
            }
            
            /* .table-row {
                display: block;
                margin-bottom: 10px;
            } */
            
            /* .table-cell {
                display: block;
                border: none;
                padding: 6px 10px;
                width: 100%;
                box-sizing: border-box;
                text-align: left;
            } */
            .table-hide{
                display: none;
            }
            .col-12{
                padding: 0%;
            }
            .table--row{
                width: 100%;
                margin: 0;
            }
             ul{
                display: inline-block;
                list-style-type: none;
                margin: 0%;
                padding: 0%;

            }
             span.dtr-title{
                display: inline-block;
                font-weight: bold;

            }
            .child{
                padding: 20px;
            }
            .table--hide{
                display:initial;
            }
            .expand-button{
                height: 16px;
                width: 16px;
                border-radius: 16px;
                position: absolute;
                display: block;
                color: white;
                box-shadow: 0 0 3px #444;
                box-sizing: content-box;
                line-height: 16px;
                background-color: green;
                 
            }
        }
        .table-row-details {
    display: none;
    
  }
  /* .pagination .step-links a.active {
    background-color: orange;
} */

</style> -->
<style> 
  .pagination a{
    color:red;
    text-decoration: none;

   }
  .act{
      border-radius: 20px;
      padding: 4px 8px;
      background-color: #007880;
      border: 1px solid #ccc;
      color:fff;
    }

  .form-tm{
    box-shadow: 2px 3px 10px #999;
    padding: 30px;
    border-radius:10px;
    margin-bottom: 20px;
  }
  .hed-tm{
    color:#ff7733;
    font-size: 36px;
    text-align: center;
    margin-bottom: 30px;
  }
  label{
    color:#666;
  }
  .form-manager{
    box-shadow: 2px 3px 10px #999;
    margin-bottom: 20px;
    padding: 30px;
    border-radius:10px;
    
  }
  .hed-manager{
    color:blue;
    font-size: 36px;
    text-align: center;
    margin-bottom: 30px;
  }
  .table-tm thead tr{
    color: #fff;
    background-color: black;
    text-align: center;

}
.table-tm tbody tr:nth-child(even){
    color: #000;
    background-color: #e6e6e6;
    text-align: center;

}
.table-tm tbody tr:nth-child(odd){
    color: #000;
    background-color: #ccc;
    text-align: center;
}
.table-manager thead tr {
        background-color: black;
        text-align: center;
        color: #ffffff;
      }
      .table-manager tbody tr:nth-child(even) {
        background-color: #e6e6e6;
        color:#000;
      }  
      .table-manager tbody tr:nth-child(odd) {
        background-color: #ccc;
        color:#000;

      }
      .hed-tl{
        color: #000;
      }
      {% if mem_role == 'Employee' and mem_team_lead_ext == 1 %}
      .table-tl table, tr, th, td{
        color: #000;
      }
      {% endif %}

    .hed-hr{
      color: #000;
    }

    .table-hr table, tr, td, th{
      color: #000;
    }

    .table-manager th{
      color: #fff;
    }
</style>
<title>Apply For Leave & History</title>
<div id="message">
  {% if messages %}
  {% for message in messages %}
  {% if message.tags == 'error' %}
  <div class="alert alert-danger" style="margin-top:20px" >{{ message }}</div>
  {% endif %}
  {% if message.tags == 'success' %}
  <div class="alert alert-success" style="margin-top:20px; background-color: green; color:whitesmoke;">{{ message }}</div>
  {% endif %}
  {% endfor %}
{% endif %}
</div>
<script>
  $("#message").show();
  setTimeout(function(){
      $("#message").hide();
  },2000)

</script>

    <!-- Main content -->
    <!-- <section class="content" style="background-color: #1e2442;">
      <div class="container-fluid" >
         <div class="row">
            <div class="col-md-10"> -->
            <!-- general form elements -->
            <!-- <div class="card " style="background-color: #242b4d; color: white;">
                  <div class="card-header" style="background-color: #1f2745;">
                    <h3 class="card-title" style="color: rgb(255, 255, 255) ; font-size: xx-large;"><b>Apply For Leave</b></h3>
                  </div> -->
              <!-- /.card-header -->
              <!-- form start -->
              <!-- <form action="{% url 'employ_apply_leave_save' %}" method="post">
                <div class="card-body" style="color: rgb(255, 255, 255);"> -->

                  <div class="row">
                    <div class="col-lg-1 col-sm-1 col-md-1">
                    </div>
                    <div class="col-lg-10 col-sm-10 col-md-10">
                        <h3 class="{% if mem_role == 'HR' and mem_hroptions == 1 %}hed-hr{% elif mem_role == 'Project Manager' and mem_projectmanagerop == 1 %}hed-manager{% elif mem_role == 'Employee' and mem_team_lead_ext == 1 %}hed-tl{% elif mem_role == 'Employee' and mem_team_lead_ext == 0 %}hed-tm {% endif %}">Apply For Leave</h3>
                        <form action="{% url 'employ_apply_leave_save' %}" method="post" class="{% if mem_role == 'HR' and mem_hroptions == 1 %}form-hr{% elif mem_role == 'Project Manager' and mem_projectmanagerop == 1 %}form-manager{% elif mem_role == 'Employee' and mem_team_lead_ext == 1 %}form-tl{% elif mem_role == 'Employee' and mem_team_lead_ext == 0 %}form-tm {% endif %}">
                          {% csrf_token %}
        
                  <div class="form-group">
                    <label >Select the leave type</label>
                    <select name="leave_type" class="form-control" required onchange="toggleToDateField(this)"
                    >
                      <option selected disabled value="">---- Select ----</option>
                      <option value="Leave">Leave</option>
                      {% if half.halfdaylev == 1 %}
                      <option value="Half-Day">Half Day</option>
                      {% else %}
                      <option value="Half-Day"disabled>Half Day</option>
                      {% endif %}
                      <option value="Unpaid_leave">Unpaid leave</option>
                      <option value="Unpaid_halfday">Unpaid Half-Day </option>
                      {% for i in half1 %}
                      <option value="{{i.type}}">{{i.type}}</option>
                      {% endfor %}


                    </select>
                   </div>
                   <div class="form-group" >
                    
                    <label>Select the Leave Date </label>
                    <!-- <div class="row">
                       {% csrf_token %}
                       <label style="font-size: medium; width: 200px;">FROM Date :<input style="background-color: #393f5c;color: white;" type="date" style="width:fit-content;" name="leave_date" class="form-control" placeholder="Leave Date">
                       </label>
                   
                       <label style="font-size: medium; width: 200px;" >TO Date:<input style="background-color: #393f5c;color: white;" type="date" style="width: fit-content;" name="to_date" class="form-control" placeholder="TO Date">
                       </label>
                  
                     </div> -->

                     
                   <!-- <script>
                      // Get today's date
                      var today = new Date();
                      var dd = String(today.getDate()).padStart(2, '0');
                      var mm = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
                      var yyyy = today.getFullYear();
                      // var minDate = yyyy + '-' + mm + '-' + dd;
                  
                      // // Set min attribute of FROM Date input to today's date
                      // document.getElementById('from_date').setAttribute('min', minDate);
                  
                      // Add event listener to FROM Date input for handling changes
                      document.getElementById('from_date').addEventListener('change', function() {
                          var fromDateValue = this.value;
                          var toDateInput = document.getElementById('to_date');
                          
                          // Set min attribute of TO Date input to fromDateValue
                          toDateInput.min = fromDateValue;
                          
                          // Check if TO Date is before FROM Date, if so, set it to FROM Date
                          if (toDateInput.value < fromDateValue) {
                              toDateInput.value = fromDateValue;
                          }
                      });
                  </script>   -->
                  <div class="row">
                    <div class="col-6">
                      <label style="font-weight: 400;">From Date:</label>
                          <input type="date" id="from_date" name="leave_date" class="form-control" min="1000-01-01" max="9999-12-31" >
                    </div>
                    <div class="col-6">
                      <label style="font-weight: 400;">To Date:</label>
                        <input type="date" id="to_date" name="to_date" class="form-control" min="1000-01-01" max="9999-12-31" >
                    </div>
                  </div>
                  <script>
                    // Get references to the date input elements
                    var fromDateInput = document.getElementById('from_date');
                    var toDateInput = document.getElementById('to_date');
                
                    // Add event listener to 'From Date' input
                    fromDateInput.addEventListener('input', function() {
                        // Parse the selected date from 'From Date' input
                        var fromDate = new Date(this.value);
                
                        // Calculate the minimum date for 'To Date' input
                        var minToDate = new Date(fromDate);
                        minToDate.setDate(fromDate.getDate() + 1); // Minimum 'To Date' is one day after 'From Date'
                
                        // Format the minimum date as 'YYYY-MM-DD' for input field
                        var minToDateFormatted = minToDate.toISOString().slice(0, 10);
                
                        // Set the minimum date for 'To Date' input
                        toDateInput.min = minToDateFormatted;
                
                        // Reset 'To Date' if it's less than the new minimum date
                        if (toDateInput.value < minToDateFormatted) {
                            toDateInput.value = minToDateFormatted;
                        }
                    });
                </script>
                    </div>

                    <!-- <script>
                      var today = new Date().toISOString().split('T')[0];
                      document.getElementsByName("to_date")[0].setAttribute('min', today);
                  </script> -->
                  
                   <div class="form-group">
                      {% if half.reason == 1 %}
                      <label >Reason for Leave*</label>
                      <textarea class="form-control" rows="6" name="leave_msg" required></textarea>
                      {% else %}
                      <label>Reason for Leave*</label>
                      <textarea class="form-control" rows="6" name="leave_msg" required ></textarea>
                      {% endif %}
                    </div>
                   
                    <input type="hidden" name="email_leave" value="{{user.email}}">
                <!-- /.card-body -->

                <div class="card-footer">
                  <button type="submit" class="btn btn-primary btn-block" id="fetch_student" style="margin-left:0%"> Submit Leave Request</button>
                </div>
              </form>
            </div><br>

            <!-- /.card -->
            <h3 class="{% if mem_role == 'HR' and mem_hroptions == 1 %}hed-hr{% elif mem_role == 'Project Manager' and mem_projectmanagerop == 1 %}hed-manager{% elif mem_role == 'Employee' and mem_team_lead_ext == 1 %}hed-tl{% elif mem_role == 'Employee' and mem_team_lead_ext == 0 %}hed-tm {% endif %}">View Past Leave Request History</h3>
            <div class="row">
              <div class="col-sm-1 col-lg-1 col-md-1">
              </div>

              <div class="col-sm-10 col-lg-10 col-md-10">

              <form id="leaveFilterForm" method="post" action="{% url 'employ_apply_leave' %}">
                {% csrf_token %}
                           <div class="form-group">
                            <label>Search for leave Status</label>
                             <!-- <input type="text" id="myInput" oninput="submitSearch()" class="form-control float-right" placeholder="Search status" style="background-color: #282f51;  border: none; color: white;"><br> -->
                            <select id="statusFilter" onchange="submitFilter()" class="form-control">
                              <option value=" ">---Select----</option>
                              <option value="approved">Approved</option>
                              <option value="rejected">Rejected</option>
                              <option value="pending">Pending</option>
                    </select>
                             
                            <!-- <select name="status" class="form-control">
                                <option value="">----Select----</option>
                                <option value="1">Approved</option>
                                <option value="2">Rejected</option>
                                <option value="0">Pending</option>
                            </select>                          -->
                        
                    
                    <!-- <div class="col" style="margin-top:30px;" >
                        <button type="submit" class="btn btn-primary">Apply Filter</button>
                    </div> -->
                </div>
              </form>
              </div>
              </div>
              <div class="row">
                <div class="col-sm-1 col-lg-1 col-md-1">
                </div>
                <div class="col-sm-10 col-lg-10 col-md-10">
                  <table class="table table-bordered {% if mem_role == 'HR' and mem_hroptions == 1 %}table-hr{% elif mem_role == 'Project Manager' and mem_projectmanagerop == 1 %}table-manager{% elif mem_role == 'Employee' and mem_team_lead_ext == 1 %}table-tl{% elif mem_role == 'Employee' and mem_team_lead_ext == 0 %}table-tm {% endif %}" id="myTable">
                    <thead >
                    <tr class="table-row">
                        <th>ID</th>
                        <th>Leave Type</th>
                        <th >From Date</th>
                        <th >To Date</th>
                        <th >Leave Message</th>
                        <th >Leave Status</th>
                    </tr></thead>
                    <tbody >
                      {% for row in leave_data %}
                                      <tr>
                                        <td >
                                          {{data.empid}}
                                      </td>
                                      <td>{{ row.leave_type }}</td>
                                      
                                      <td>{{ row.leave_date }}</td>
                                      <td>{{ row.to_date }}</td>
                                      <td>{{ row.leave_message }}</td>
                                      <td >
                                          {% if row.leave_status == 1 %}
                                              <span class="alert alert-success">Approved</span>
                                          {% elif row.leave_status == 2 %}
                                              <span class="alert alert-danger">Rejected</span>
                                          {% else %}
                                              <span class="alert alert-info ">Pending</span>
                                          {% endif %}
                                      </td>
                                  </tr>
                                  {% empty %}
                                      <tr>
                                        <td colspan="6" class="text-center" style="color: red;">There are no leave requests has to be found.....

                                        </td>
                                      </tr>

<!--                             
                            <tr class="table-row-details">
                              <td class="child" colspan="6" style="padding: 20px;">
                                  <ul data-dtr-index="0" >
                                      <li data-dtr-index="3" >
                                          <span class="dtr-title"> Leave Date</span>
                                      <span class="dtr-data">
                                          <p class="text-success">{{row.leave_date}}</p> </span></li>
                                      <li data-dtr-index="4" >
                                          <span class="dtr-title"> To Date</span>
                                          <span class="dtr-data">
                                              <p class="text-success">{{row.to_date}}</p> </span>
                                          </li>
                                      <li data-dtr-index="5" >
                                          <span class="dtr-title"> Leave Message</span>
                                          <span class="dtr-data">
                                              <p class="text-success">{{row.leave_message}}</p> </span>
                                            </li>
                                      <li data-dtr-index="6">
                                        {% if row.leave_status == 1 %}
                                        <span class="alert alert-success">Approved</span>
                                        {% elif row.leave_status == 2 %}
                                        <span class="alert alert-danger">Rejected</span>
                                        {% else %}
                                        <span class="alert alert-info ">Pending</span>
                                        {% endif %}
                                      </li>
                                  </ul>
                              </td>
                              
                              
                              
                            </tr> -->
                            {% endfor %}  
                          </tbody> 
                                         
                
                </table>

                <div class="pagination">
                  <span class="step-links">
                      {% if leave_data.has_previous %}
                          <a  href="?page=1">First</a>
                          <a   href="?page={{ leave_data.previous_page_number }}" class="prev"> << </a>
                      {% endif %}
              
              
                      {% for i in leave_data.paginator.page_range %}
                      {% if leave_data.number == i %}
                      <button class="active act "><span>{{ i }} <span class="sr-only">(current)</span></span></button>
                      {% elif i > leave_data.number|add:'-3' and i < leave_data.number|add:'3' %}
                          <a  href="?page={{ i }}">{{ i }}</a>
                      {% endif %}
                      {% endfor %}
              
                     
              
                      {% if leave_data.has_next %}
                          {% if leave_data.number != leave_data.paginator.num_pages %}
                          {% endif %}
                          <a   href="?page={{ leave_data.next_page_number }}" class="prev">>> </a>
              
                          <a  href="?page={{ leave_data.paginator.num_pages }}">Next </a>
                      {% endif %}
                  </span>
              <!-- <div class="pagination" style="margin-left: 610px; color: white; padding-left: 24px;">
                <span class="step-links">
                    {% if leave_data.has_previous %}
                        <a href="?page=1" style="border: 1px solid #ccc; border-radius: 8px; padding: 5px; margin: 2px;">First</a>
                        <a href="?page={{ leave_data.previous_page_number }}" class="prev" style="border: 1px solid #ccc; border-radius: 8px; padding: 5px; margin: 2px;">&lt;&lt;</a>
                    {% endif %}
            
                    {% for page in leave_data.paginator.page_range %}
                        <a href="?page={{ page }}" {% if page == leave_data.number %}class="active"{% endif %}
                           style="border: 2px solid #ccc; border-radius: 8px; padding: 10px; margin: 2px;">
                           {{ page }}
                        </a>
                    {% endfor %}
            
                    {% if leave_data.has_next %}
                        {% if leave_data.number != leave_data.paginator.num_pages %}
                            <a href="?page={{ leave_data.paginator.num_pages }}" style="border: 2px solid #ccc; border-radius: 8px; padding: 5px; margin: 2px;">&gt;&gt;</a>
                        {% endif %}
                    {% endif %}
                </span>
            </div> -->
            <!-- <div class="pagination" style="color:white;">
              <span class="step-links">
                  {% if leave_data.has_previous %}
                      <a  href="?page=1">&laquo;<<</a>
                      <a   href="?page={{ leave_data.previous_page_number }}" class="prev"> < </a>
                  {% endif %}
          
      
                  {% for i in leave_data.paginator.page_range %}
                  {% if leave_data.number == i %}
                  <button class="active act bg-info"><span>{{ i }} <span class="sr-only">(current)</span></span></button>
                  {% elif i > leave_data.number|add:'-3' and i < leave_data.number|add:'3' %}
                      <a  href="?page={{ i }}">{{ i }}</a>
                  {% endif %}
                  {% endfor %}
      
                 
      
                  {% if leave_data.has_next %}
                      {% if leave_data.number != leave_data.paginator.num_pages %}
                      {% endif %}
                      <a   href="?page={{ leave_data.next_page_number }}" class="prev">> </a>
      
                      <a  href="?page={{ leave_data.paginator.num_pages }}">>>&raquo; </a>
                  {% endif %}
              </span>
          </div>    -->
          
               
            </div>


          </div>

         
          
        </div>

        
      </div>
      <div class="col-lg-1 col-sm-1 col-md-1">
      </div>

  </div>
     
      <!-- <script>
      function submitFilter() {
        var selectedStatus = document.getElementById("statusFilter").value;
        var table = document.getElementById("myTable");
        var tr = table.getElementsByTagName("tr");
    
        for (var i = 0; i < tr.length; i++) {
          var statusCell = tr[i].getElementsByTagName("td")[5]; // 6th column contains status
          if (statusCell) {
            var status = statusCell.innerText.toLowerCase().trim();
            if (selectedStatus === " " || status === selectedStatus) {
              tr[i].style.display = "";
            } else {
              tr[i].style.display = "none";
            }
          }
        }
      }
    </script>


    <script>
      function submitLeaveFilterForm() {
          var form = document.getElementById('leaveFilterForm');
          console.log('Form submitting...');
          console.log('Selected Status:', form.elements.ss.value);
          form.submit();
      }
  </script>
      <script>
      function toggleRow(button) {
        const row = button.parentNode.parentNode;
        const detailsRow = row.nextElementSibling;
        detailsRow.classList.toggle('table-row-details');
        button.textContent = detailsRow.classList.contains('table-row-details') ? '+' : '-';
      }
    </script>
  <script>
      const headers = document.querySelectorAll('.sortable');
      let currentColumn = '';
      let isAscending = true;
    
      headers.forEach(header => {
        header.addEventListener('click', () => {
          const column = header.getAttribute('data-column');
          if (column === currentColumn) {
            isAscending = !isAscending;
          } else {
            currentColumn = column;
            isAscending = true;
          }
    
          // Update arrow direction
          headers.forEach(h => {
            if (h === header) {
              h.textContent = `${h.getAttribute('data-column')} ${isAscending ? '▲' : '▼'}`;
            } else {
              h.textContent = `${h.getAttribute('data-column')} ▼`;
            }
          });
    
          // Sort the table
          const table = header.closest('table');
          const rows = Array.from(table.querySelectorAll('tr')).slice(1);
          rows.sort((rowA, rowB) => {
            const cellA = rowA.querySelector(`td:nth-child(${currentColumn === 'item' ? 1 : 2})`).textContent;
            const cellB = rowB.querySelector(`td:nth-child(${currentColumn === 'item' ? 1 : 2})`).textContent;
            return isAscending ? cellA.localeCompare(cellB) : cellB.localeCompare(cellA);
          });
          table.tBodies[0].append(...rows);
        });
      });
    
      const searchInput = document.getElementById('searchInput');
      searchInput.addEventListener('input', () => {
        const searchTerm = searchInput.value.trim().toLowerCase();
        const rows = Array.from(document.querySelectorAll('tr')).slice(1);
    
        rows.forEach(row => {
          const cells = Array.from(row.querySelectorAll('td'));
          const rowText = cells.map(cell => cell.textContent.trim().toLowerCase());
          const isVisible = rowText.some(text => text.includes(searchTerm));
          row.style.display = isVisible ? '' : 'none';
        });
      });
    </script>
    
    <script type="text/javascript">
      $(document).ready(function () {
        // Filter table
        $("#myInput").on("keyup", function () {
          var value = $(this).val().toLowerCase();
          var rows = $("#myTable tr").filter(function () {
            return $(this).text().toLowerCase().indexOf(value) > -1;
          });
    
          // Hide all rows initially
          $("#myTable tr").hide();
          
          if (rows.length > 0) {
            // If there are matching rows, show them
            rows.show();
            // Hide the "No data found" row
            $("#noDataFoundRow").hide();
          } else {
            // If no matching rows, show the "No data found" row
            $("#noDataFoundRow").show();
          }
        });
      });
  </script>
  <script>
    function submitSearch() {
      var input = document.getElementById("myInput");
      var filter = input.value.toUpperCase();
      var table = document.getElementById("employeeData"); // Corrected the table ID
      var tr = table.getElementsByTagName("tr");
    
      for (var i = 1; i < tr.length; i++) {
        var found = false;
        var td = tr[i].getElementsByTagName("td");
    
        for (var j = 0; j < td.length; j++) {
          var txtValue = td[j].textContent || td[j].innerText;
    
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            found = true;
            break;
          }
        }
    
        if (found) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
      }
    }
      </script>
      <script>
        function toggleToDateField(selectElement) {
            var selectedLeaveType = selectElement.value;
            var toDateField = document.getElementById("to_date");
            
            // Enable or disable the TO date field based on the selected leave type
            if (selectedLeaveType === "Half-Day" || selectedLeaveType === "Unpaid_halfday") {
                toDateField.disabled = true;
                toDateField.value = ""; // Clear the value if it was already selected
            } else {
                toDateField.disabled = false;
            }
        }
        </script>
     /.content -->
     <script>
      function submitFilter() {
          var selectedStatus = document.getElementById("statusFilter").value.toLowerCase().trim();
          var table = document.getElementById("myTable");
          var tr = table.getElementsByTagName("tr");
          var noDataMessage = document.getElementById("noDataMessage");
          var rowsVisible = false;
  
          for (var i = 0; i < tr.length; i++) {
              var statusCell = tr[i].getElementsByTagName("td")[5]; // 6th column contains status
              if (statusCell) {
                  var status = statusCell.innerText.toLowerCase().trim();
                  if (selectedStatus === " " || status === selectedStatus) {
                      tr[i].style.display = "";
                      rowsVisible = true;
                  } else {
                      tr[i].style.display = "none";
                  }
              }
          }
  
          // Check if any rows are visible and display the "No data found" message if necessary
          if (!rowsVisible) {
              if (!noDataMessage) {
                  // Create the "No data found" message element if it doesn't exist
                  noDataMessage = document.createElement("div");
                  noDataMessage.id = "noDataMessage";
                  noDataMessage.style.color = "red";
                  noDataMessage.textContent = "There is no records available for search items.....";
                  noDataMessage.style.textAlign = "center";

                  table.parentNode.insertBefore(noDataMessage, table.nextSibling);
              } else {
                  noDataMessage.style.display = ""; // Show the existing message
              }
          } else {
              if (noDataMessage) {
                  noDataMessage.style.display = "none"; // Hide the message if rows are visible
              }
          }
      }
  </script>    
<script>
  function toggleToDateField(selectElement) {
    var selectedLeaveType = selectElement.value;
    var toDateField = document.getElementById("to_date");

    // Enable or disable the TO date field based on the selected leave type
    if (selectedLeaveType === "Half-Day" || selectedLeaveType === "Unpaid_halfday") {
        toDateField.disabled = true;
        toDateField.value = ""; // Clear the value if it was already selected
    } else {
        toDateField.disabled = false;
        toDateField.min = leave_date.value; // Set min attribute to leave_date
        toDateField.value = leave_date.value; // Set value to leave_date
    }
}
</script>

{% endblock main_content %} 